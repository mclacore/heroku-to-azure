# Migrate your Heroku CI/CD pipeline to Azure DevOps Pipelines

## Prerequisites

- [Azure DevOps account](https://dev.azure.com/)
- Your code hosted in a Git repo

## Create a new pipeline

Azure DevOps Pipelines has a useful GUI for customizing your pipeline. To experience the GUI:

1. Log into [Azure DevOps](https://aex.dev.azure.com) and navigate to your project.
2. Click on Pipelines and then `New Pipeline`.
3. Choose where your code is, e.g. `Azure Repos Git`.
4. Select your repository.

_Continue to one of the sections below to configure your pipeline._

## Continuous Integration

1. Select the CI template for your runtime.
2. Review the YAML and click `Save and run` to save the pipeline and run it.

## Continuous Deployment

### Azure App Service

1. Choose one of the `... Web App on Azure` templates for your runtime.
2. Select your Azure subscription.
3. Select your App Service.
4. Review the YAML and click `Save and run` to save the pipeline and run it.

> [!NOTE]
> Azure DevOps only lists templates for `Python`, `PHP`, `Maven`, and `Node.js (React | Express)`. For other runtimes, you can use the `Starter pipeline` template and manually configure it. I'd suggest viewing the templates for one of the Node.js templates for guidance on structure.

### Azure Kubernetes Service (AKS)

1. Choose the `Deploy to Azure Kubernetes Service` template.
2. Select your Azure subscription.
3. Choose your AKS cluster.
4. Expand the `Namespace` dropdown and select the namespace that your application is deployed to (probably `default`).
5. Expand the `Container registry` dropdown and select the registry that your application image is hosted in.
6. Enter in the image name for your image and the service port to `8080`.
7. You can enable `Review App for Pull Requests` for [review app](https://learn.microsoft.com/en-us/azure/devops/pipelines/process/environments-kubernetes?view=azure-devops) related configuration to be included in the pipeline YAML autogenerated in subsequent steps.
8. Select `Validate and configure` to generate the YAML.
9. Review the YAML and click `Save and run` to save the pipeline and run it.

## Sources

- [CI/CD with Azure Pipelines for AKS](https://learn.microsoft.com/en-us/azure/aks/devops-pipeline)
